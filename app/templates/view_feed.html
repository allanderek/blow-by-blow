{% extends "base.html" %}
{% block content %}
<h1>
    {{db_feed.feed_title}}
</h1>
    {% if secret is not none %}
    <form id='change-title' method="POST"
          action="{{ url_for('change_feed_title',
                             feed_no=db_feed.id,
                             secret=secret) }}">
        {{ change_title_form.hidden_tag() }}
        {{ change_title_form.title_text.label }}
        {{ change_title_form.title_text() }}
    </form>
    {% endif %}


{% if secret is not none %}
    <div id="commentate-area">
        <form id="make-comment"
              method="POST"
              action="{{ url_for('commentate_on_feed', feed_no=db_feed.id,
                                 secret=secret) }}">
                {{ commentate_form.hidden_tag() }}
                {{ commentate_form.comment_text.label }}
                {{ commentate_form.comment_text() }}
                <button type="submit"
                        class="commentate_button"
                        id="commentate_button"
                        name="commentate_button">Update</button>
            </form>
    </div>
{% endif %}


<ul id="feed-moment-list">
    {% for moment in db_feed.moments %}
        <li><span class="comment-time">{{moment.date_time.isoformat()}}</span>
            <span class="comment-text">{{moment.content}}</span></li>
    {% endfor %}
</ul>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
    /* We have now stopped using server-side events and we're just
       going to instead use some ajax to automatically re-load the
       event-stream.
    */
</script>


{% endblock %}
