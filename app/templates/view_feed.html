{% extends "base.html" %}
{% block content %}
<h1>{{db_feed.id}}</h1>

<ul>
    {% for moment in db_feed.moments %}
        <li>{{moment.content}}</li>
    {% endfor %}
</ul>
<pre id="out"></pre>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
    function sse() {
        var source = new EventSource('/stream');
        var out = document.getElementById('out');
        source.onmessage = function(e) {
            // XSS in chat is fun
            out.innerHTML =  e.data + '\\n' + out.innerHTML;
        };
    }
    sse();
</script>


{% endblock %}
