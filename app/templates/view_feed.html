{% extends "base.html" %}
{% block content %}
<h1>{{db_feed.id}}</h1>

<ul id="feed-moment-list">
    {% for moment in db_feed.moments %}
        <li>{{moment.content}}</li>
    {% endfor %}
</ul>
<pre id="out"></pre>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
    function sse() {
        var source = new EventSource('/stream/{{db_feed.id}}');
        var out = document.getElementById('feed-moment-list');
        source.onmessage = function(e) {
            // XSS in chat is fun
            // out.innerHTML =  e.data + '\\n' + out.innerHTML;
            var li = document.createElement('li');
            out.appendChild(li);
            li.innerHTML = e.data;

        };
    }
    sse();
</script>


{% endblock %}
